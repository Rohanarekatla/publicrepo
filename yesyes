import re

def generate_html_body(file_path):
    html_body = """<!DOCTYPE html>
    <html>
    <head>
        <style>
            table {
                font-family: helvetica;
                border-collapse: collapse;
                width: 100%;
                table-layout: fixed;
            }
            th, td {
                border: 1px solid #dddddd;
                text-align: left;
                padding: 8px;
            }
            th {
                background-color:#f2f2f2;
            }
        </style>
    </head>
    <body>"""

    with open(file_path, 'r') as file:
        lines = file.readlines()

    current_section = None
    in_table = False
    
    for line in lines:
        line = line.strip()
        
        # Check for account name
        match = re.search(r'SNOWFLAKE ACOUNT NAME\s*:\s*(.*)', line)
        if match:
            if in_table:
                html_body += "</table>"
                in_table = False
                
            account_name = match.group(1).strip()
            html_body += f"<h3>Snowflake Account Name: {account_name}</h3>"
            html_body += "<table>"
            in_table = True
            continue

        # Check for table headers
        if '<tr><th>' in line:
            html_body += line
            continue
            
        # Check for table data
        if '<tr><td>' in line:
            # Clean up and add the data row
            html_body += line
            continue
            
    # Close the last table if needed
    if in_table:
        html_body += "</table>"

    html_body += """
    </body>
    </html>"""
    
    return html_body

# Usage example
if __name__ == "__main__":
    file_path = r'C:\Users\Varohan\Downloads\filenotificationtask\demo1.out'
    html_content = generate_html_body(file_path)
    
    # Save the output to a file
    output_file = r'C:\Users\Varohan\Downloads\filenotificationtask\output.html'
    with open(output_file, 'w', encoding='utf-8') as f:
        f.write(html_content)
